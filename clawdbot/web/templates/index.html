{% extends "base.html" %}

{% block title %}Dashboard - ClawdBot{% endblock %}

{% block content %}
<div class="card">
    <h2>System Status</h2>
    <p>Gateway: <span class="status online">Running</span></p>
    <p>Port: {{ config.gateway.port }}</p>
    <p>Bind: {{ config.gateway.bind }}</p>
</div>

<div class="card">
    <h2>Channels</h2>
    {% if channels %}
    <table>
        <thead>
            <tr>
                <th>Channel</th>
                <th>Status</th>
                <th>Capabilities</th>
            </tr>
        </thead>
        <tbody>
            {% for channel in channels %}
            <tr>
                <td>{{ channel.label }}</td>
                <td>
                    {% if channel.is_running() %}
                    <span class="status online">Running</span>
                    {% else %}
                    <span class="status offline">Stopped</span>
                    {% endif %}
                </td>
                <td>{{ channel.capabilities.chat_types|join(', ') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No channels configured</p>
    {% endif %}
</div>

<div class="card">
    <h2>Agent Configuration</h2>
    <p><strong>Model:</strong> {{ config.agent.model }}</p>
    <p><strong>Verbose:</strong> {{ config.agent.verbose }}</p>
</div>

<div class="card">
    <h2>Quick Actions</h2>
    <a href="/webchat" class="btn">Open WebChat</a>
    <button class="btn btn-secondary" onclick="refreshStatus()">Refresh Status</button>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
async function refreshStatus() {
    try {
        const response = await fetch('/api/status');
        const data = await response.json();
        console.log('Status:', data);
        alert('Status refreshed! Check console for details.');
    } catch (error) {
        console.error('Failed to refresh status:', error);
        alert('Failed to refresh status');
    }
}
</script>
{% endblock %}
